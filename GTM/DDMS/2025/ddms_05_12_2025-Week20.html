<script>
  $("#site-nav .promo-bottom").each(function () {
    var $this = $(this),
      isRecognized = getCookie("fdRecognized") !== undefined,
      setPg = "",
      clMsg = '<div class="weight-bold size-18 mb-3">Free Shipping</div><div class="size-15">On Contact Lens<br>Orders over $175</div>'
    isQC = window.location.host === 'qc.framesdirect.com';

    $this.css("backgroundColor", "#fff");
    $this.attr("style", "cursor: pointer");

    //------ We need an insurance condition to determine when this should or shouldn't show
    //------ This will only show on QC for now
    if (isQC) {
      if (
        !$this.parents('.top-items').hasClass('top-sale') &&
        (
          (checkDate >= '250417' && checkDate <= '250630') ||
          (fdFncs.vars.isTest >= '250417' && checkDate <= '250630')
        )
      ) {
        $this.css('backgroundColor', '#D6F3E9');
        if ($this.parents('.top-items').hasClass('top-cl')) {
          $this.append(
            clMsg
          )
          setPg = '/contact-lenses/';
        } else if ($this.parents('.top-items').hasClass('top-sale')) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            'background-red color-white weight-bold transform-uppercase'
          )
        } else if ($this.parents('.top-items').hasClass('top-sg')) {
          $this.append(
            '<div><p class="mt-0">Up to</p> <span class="weight-bold size-18">50% OFF<br>FRAMES</span></div>'
          );
        } else {
          $this.append(
            '<p class="weight-bold size-14">Purchasing with<br>insurance, made easy</p><div class="d-flex flex-wrap justify-content-center align-items-center"><div class="col-12 p-0"><img src="https://images.framesdirect.com/image/upload/v1742409416/insurance/logo-eyemed.png" width="50" height="30" alt="EyeMed" class="m-2"> <img src="https://images.framesdirect.com/image/upload/v1742409416/insurance/logo-aetna.png" width="90" height="18" alt="Aetna" class="m-2"></div><div class="col-12 p-0"><img src="https://images.framesdirect.com/image/upload/v1742409416/insurance/logo-humana.png" width="90" height="18" alt="Humana" class="m-2"> <img src="https://images.framesdirect.com/image/upload/v1742409416/insurance/logo-cigna.png" width="65" height="39" alt="Cigna" class="m-2"></div></div><p>...and many more!</p>'
          );
          $this.css('max-width', '200px');
          if ($this.parents('.top-items').hasClass('top-eg')) {
            $this.attr('data-element-id', 'MainNav_Eyeglasses_VisionInsurance');
          } else if ($this.parents('.top-items').hasClass('top-ps')) {
            $this.attr('data-element-id', 'MainNav_PrescriptionSunglasses_VisionInsurance');
          }
          setPg = '/knowledge-center/vision-insurance-fsa-eligibility';
        }
      } else {
        $this.css("backgroundColor", "#C7C9AF");
        setPg = "/sale/top-brands-discounted-dp";
        //$this.css("backgroundColor", "#A7E5DA");
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
          setPg = "/sale/designer-eyewear-outlet-dp";
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div><p class="mt-0">Up to</p> <span class="weight-bold size-18">50% OFF<br>FRAMES</span></div>'
          );
        } else {
          $this.append(
            '<div>Up to</div><div class="weight-bold size-18">50% OFF FRAMES</div><div class="weight-bold size-18">+</div><div>Up to</div><div class="weight-bold size-18">60% OFF LENSES</div>'
          );
        }
      }
      // -------------- Only Edit Below for active campaigns ---------------
    } else { //Only needed to ensure the active rules don't apply to QC for now
      // -------------- Wrapper needed for QC ^^^^ -------------------------

      if (
        !$this.parents(".top-items").hasClass("top-sale") &&
        ((checkDate >= "250513" && checkDate <= "250518") ||
          (fdFncs.vars.isTest >= "250513" && checkDate <= "250518"))
      ) {
        $this.css("backgroundColor", "#F0ECE1");
        setPg = "/sale/top-brands-discounted-dp";
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div class="size-14 weight-bold">YOUR COMPLETE PAIR</div><div class="size-16"><span class="weight-bold">40% OFF<br> SELECT FRAMES</div>'
          );
          setPg = "/email/designer-brands-dp";
        } else {
          $this.append(
            '<div class="size-14 weight-bold">YOUR COMPLETE PAIR</div><div class="size-16"><span class="weight-bold">40% OFF<br>SELECT FRAMES<br> + <br>UP TO 60% OFF <br>LENSES</div>'
          );
          setPg = "/email/designer-brands-dp";
        }
      } else if (
        !$this.parents(".top-items").hasClass("top-sale") &&
        ((checkDate >= "250512" && checkDate <= "250512") ||
          (fdFncs.vars.isTest >= "250512" && checkDate <= "250512"))
      ) {
        $this.css("backgroundColor", "#CBC4BA");
        setPg = "/sale/top-brands-discounted-dp";
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div class="size-16 weight-bold"><div class="size-10 mb-1">YOUR COMPLETE PAIR </div> UP TO 40% OFF<br>SELECT FRAMES</div>'
          );
          setPg = "/email/mothers-day-dp";
        }
        else {
          $this.append(
            '<div class="size-16 weight-bold"><div class="size-10 mb-1">YOUR COMPLETE PAIR </div> UP TO 40% OFF<br>SELECT FRAMES<div class="weight-bold size-16 m-2">+</div>UP TO 60% OFF <br> LENSES</div>'
          );
          setPg = "/email/mothers-day-dp";
        }
      } else if (
        !$this.parents(".top-items").hasClass("top-sale") &&
        ((checkDate >= "250508" && checkDate <= "250511") ||
          (fdFncs.vars.isTest >= "250508" && checkDate <= "250511"))
      ) {
        $this.css("backgroundColor", "#CBC4BA");
        setPg = "/sale/top-brands-discounted-dp";
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div class="size-16 weight-bold">Up to 40% off<br> Ray-Ban, Oakley,<br> Costa & more</div>'
          );
          setPg = "/email/mothers-day-dp";
        }
        else if ($this.parents(".top-items").hasClass("top-ps")) {
          $this.append(
            '<div class="size-16 weight-bold">Up to 40% off<br> Ray-Ban, Oakley,<br> Costa & more<div class="weight-bold size-16 m-2">+</div>60% off lenses</div'
          );
          setPg = "/email/mothers-day-dp";
        } else {
          $this.append(
            '<div class="size-16 weight-bold">Up to 40% off<br> Burberry, Versace<br> & more<br><div class="weight-bold size-16 m-2">+</div>60% off lenses</div>'
          );
          setPg = "/email/mothers-day-dp";
        }
      } else if (
        !$this.parents(".top-items").hasClass("top-sale") &&
        ((checkDate >= "250428" && checkDate <= "250507") ||
          (fdFncs.vars.isTest >= "250428" && checkDate <= "250507"))
      ) {
        $this.css("backgroundColor", "#F0ECE1");
        setPg = "/sale/top-brands-discounted-dp";
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div class="size-16"><span class="weight-bold">40% OFF<br> DESIGNER <br>BRANDS</div>'
          );
          setPg = "/email/designer-brands-dp";
        } else {
          $this.append(
            '<div class="size-16"><span class="weight-bold">40% OFF<br> DESIGNER <br>BRANDS<br> + <br>UP TO 60% OFF <br>LENSES</div>'
          );
          setPg = "/email/designer-brands-dp";
        }
      } else if (
        !$this.parents('.top-items').hasClass('top-sale') &&
        (
          (checkDate >= '250417' && checkDate <= '250428') ||
          (fdFncs.vars.isTest >= '250417' && checkDate <= '250428')
        )
      ) {
        $this.css('backgroundColor', '#D1595A');
        if ($this.parents('.top-items').hasClass('top-cl')) {
          $this.append(
            clMsg
          )
          setPg = '/contact-lenses/';
        } else if ($this.parents('.top-items').hasClass('top-sale')) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            'background-red color-white weight-bold transform-uppercase'
          )
        } else if ($this.parents('.top-items').hasClass('top-sg')) {
          if (isRecognized) {
            $this.append(
              '<div>Up to</div><div class="weight-bold size-18">30% OFF<br> FRAMES</div>'
            );
            setPg = '/email/customer-appreciation-dp';
          } else {
            $this.append(
              '<div class="weight-bold size-21 pb-2"><a href="#" class="emailSignUp weight-bold">Sign up</a><br>or <a href="#" class="siteSignIn weight-bold">sign in</a></div><div>to unlock up<br> to 30% off top brands<br> + 65% off lenses</div>'
            );
          }
        } else {
          if (isRecognized) {
            $this.append(
              '<div class="size-16">Up to<br> <span class="weight-bold">30% OFF FRAMES</span></div><div class="weight-bold size-16">+</div><div class="weight-bold size-16">65% OFF LENSES</div><div class="size-14 mt-2">Code: EXTRA5</div>'
            );
            setPg = '/email/customer-appreciation-dp';
          } else {
            $this.append(
              '<div class="weight-bold size-21 pb-2"><a href="#" class="emailSignUp weight-bold">Sign up</a><br>or <a href="#" class="siteSignIn weight-bold">sign in</a></div><div>to unlock up<br> to 30% off top brands<br> + 65% off lenses</div>'
            );
          }
        }
      } else if (
        !$this.parents(".top-items").hasClass("top-sale") &&
        ((checkDate >= "250411" && checkDate <= "250416") ||
          (fdFncs.vars.isTest >= "250411" && checkDate <= "250416"))
      ) {
        $this.css("backgroundColor", "#D3BDAF");
        setPg = "/sale/top-brands-discounted-dp";
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div class="size-16"><span class="weight-bold">UP TO 50% OFF <br>FRAMES</div><div class="size-14 mt-2">350+ newly added styles </div>'
          );
          setPg = "/sale";
        } else {
          $this.append(
            '<div class="size-16"><span class="weight-bold">UP TO 50% OFF <br>FRAMES</div><div class="size-14 mt-2">350+ newly added styles </div><div class="weight-bold size-16">+</div><div class="weight-bold size-16">65% OFF LENSES</div><div>Code: <b>EXTRA5</b></div>'
          );
          setPg = "/sale";
        }
      } else {
        $this.css("backgroundColor", "#C7C9AF");
        setPg = "/sale/top-brands-discounted-dp";
        //$this.css("backgroundColor", "#A7E5DA");
        if ($this.parents(".top-items").hasClass("top-cl")) {
          $this.append(clMsg);
          setPg = "/contact-lenses/";
        } else if ($this.parents(".top-items").hasClass("top-sale")) {
          $this.append(
            '<div class="size-14">Outlet Deals</div><div class="size-18 pt-2 mt-2" style="line-height: 1; border-top: 1px #fff solid;">Save Up To</div><div class="size-40" style="line-height: 1;">50%</div>'
          );
          $this.addClass(
            "background-red color-white weight-bold transform-uppercase"
          );
          setPg = "/sale/designer-eyewear-outlet-dp";
        } else if ($this.parents(".top-items").hasClass("top-sg")) {
          $this.append(
            '<div><p class="mt-0">Up to</p> <span class="weight-bold size-18">50% OFF<br>FRAMES</span></div>'
          );
        } else {
          $this.append(
            '<div>Up to</div><div class="weight-bold size-18">50% OFF FRAMES</div><div class="weight-bold size-18">+</div><div>Up to</div><div class="weight-bold size-18">60% OFF LENSES</div>'
          );
        }
      }
      // ----------- Only needed for QC for now per insurance vvvvv -----------
    }
    // ----------------------------------------------------------------------
    if (setPg !== "") {
      $this.on("click", function () {
        window.location.href = setPg;
      });
    }
  });
</script>