<script>
  ////////////////////////////////////
  //for Eyeglasses and Plano Sun PDPs
  ////////////////////////////////////

  function prodDiscoBanner() {
    if (
      (checkDate >= "250513" && checkDate <= "250518") ||
      (fdFncs.vars.isTest >= "250513" && fdFncs.vars.isTest <= "250518")
    ) {
      var excludePgs =
        $('h1:contains("Gunnar")').length === 0 &&
        $('h1:contains("Kaenon")').length === 0 &&
        $('h1:contains("Randolph")').length === 0 &&
        $('h1:contains("Rec Specs")').length === 0 &&
        $('h1:contains("Zeal")').length === 0;

      if ($(".lens-bar-holder").length > 0) {
        $(".lens-bar-holder").remove();
      }

      if (($('h1:contains("Prescription")').length > 0 || $('h1:contains("Eyeglasses")').length > 0 || $('h1:contains("Sunglasses")').length > 0) && excludePgs) {
        $(
          '<div class="lens-bar-holder mx-0 mb-3 "><div class="lens-bar d-block color-black px-2 size-12 text-left" style="background:#F0ECE1; border-radius: 5px;">Up to <b>40% off select frames</b> at checkout + <b>60% off lenses</b></div></div>'
        ).prependTo("#prod-header-right");
      }
    } else
      if (
        (checkDate >= "250512" && checkDate <= "250512") ||
        (fdFncs.vars.isTest >= "250512" && fdFncs.vars.isTest <= "250512")
      ) {
        var excludePgs =
          $('h1:contains("Gunnar")').length === 0 &&
          $('h1:contains("Kaenon")').length === 0 &&
          $('h1:contains("Randolph")').length === 0 &&
          $('h1:contains("Rec Specs")').length === 0 &&
          $('h1:contains("Zeal")').length === 0;

        if ($(".lens-bar-holder").length > 0) {
          $(".lens-bar-holder").remove();
        }

        if (($('h1:contains("Prescription")').length > 0 || $('h1:contains("Eyeglasses")').length > 0 || $('h1:contains("Sunglasses")').length > 0) && excludePgs) {
          $(
            '<div class="lens-bar-holder mx-0 mb-3 "><div class="lens-bar d-block color-black px-2 size-12 text-left" style="background:  #CBC4BA; border-radius: 5px;">Give Mom A Complete Pair: Up to <b>40% off select frames</b> at checkout + <b>60% off lenses</b></div></div>'
          ).prependTo("#prod-header-right");
        }
      } else
        if (
          (checkDate >= "250428" && checkDate <= "250507") ||
          (fdFncs.vars.isTest >= "250428" && fdFncs.vars.isTest <= "250507")
        ) {
          var excludePgs =
            $('h1:contains("Gunnar")').length === 0 &&
            $('h1:contains("Kaenon")').length === 0 &&
            $('h1:contains("Randolph")').length === 0 &&
            $('h1:contains("Rec Specs")').length === 0 &&
            $('h1:contains("Zeal")').length === 0;

          if ($(".lens-bar-holder").length > 0) {
            $(".lens-bar-holder").remove();
          }

          if (($('h1:contains("Prescription")').length > 0 || $('h1:contains("Eyeglasses")').length > 0 || $('h1:contains("Sunglasses")').length > 0) && excludePgs) {
            $(
              '<div class="lens-bar-holder mx-0 mb-3 "><div class="lens-bar d-block color-black px-2 size-12 text-left" style="background:  #ACB9BF; border-radius: 5px;">Get your complete pair:<b> 40% off select frames</b> at checkout<br><b>40% off sun lenses </b>by Oakley, Costa & Maui Jim with code <b>SPECIAL40</b></div></div>'
            ).prependTo("#prod-header-right");
          }
        } else if (
          (checkDate >= "250417" && checkDate <= "250427") ||
          (fdFncs.vars.isTest >= "250417" && fdFncs.vars.isTest <= "250427")
        ) {
          var excludePgs =
            $('h1:contains("Gunnar")').length === 0 &&
            $('h1:contains("Kaenon")').length === 0 &&
            $('h1:contains("Randolph")').length === 0 &&
            $('h1:contains("Rec Specs")').length === 0 &&
            $('h1:contains("Zeal")').length === 0;

          if ($(".lens-bar-holder").length > 0) {
            $(".lens-bar-holder").remove();
          }
          if (
            $('h1:contains("Prescription Sunglasses")').length > 0 &&
            ($('h1:contains("Costa")').length > 0 || $('h1:contains("Oakley")').length > 0)
          ) {
            $(
              '<div class="lens-bar-holder mx-0 mb-3"><div class="lens-bar d-block color-black px-2 size-12 text-center" style="background:  #D1595A; border-radius: 5px;"><b>Youâ€™re saving 40% off sun prescription lenses. Discount automatically applied at checkout.</b></div></div>'
            ).prependTo("#prod-header-right");
          } else {
            if (
              ($('h1:contains("Prescription")').length > 0 ||
                $('h1:contains("Eyeglasses")').length > 0) &&
              excludePgs
            ) {
              if (getCookie("fdRecognized") !== undefined) {
                $(
                  '<div class="lens-bar-holder mx-0 mb-3"><div class="lens-bar d-block color-black px-2 size-12 text-center" style="background:  #D1595A; border-radius: 5px;"><b>Extra 5% off 60% off lenses with code EXTRA5</b></div></div>'
                ).prependTo("#prod-header-right");
              } else {
                $(
                  '<div class="lens-bar-holder mx-0 mb-3"><div class="lens-bar d-block color-black px-2 size-12 text-center" style="background: #D1595A; border-radius: 5px;"><a href="javascript:addWelcomeLayer();fdFncs.vars.allowEmPop = false;" class="weight-bold">Sign up</a> or <a href="#" class="siteSignIn weight-bold">sign in</a> to unlock up to 30% off top brands and 65% off lenses</div></div>'
                ).prependTo("#prod-header-right");
              }
            }
          }
        }
        else if (
          (checkDate >= "250410" && checkDate <= "250416") ||
          (fdFncs.vars.isTest >= "250410" && fdFncs.vars.isTest <= "250416")
        ) {
          var excludePgs =
            $('h1:contains("Gunnar")').length === 0 &&
            $('h1:contains("Kaenon")').length === 0 &&
            $('h1:contains("Maui Jim")').length === 0 &&
            $('h1:contains("Randolph")').length === 0 &&
            $('h1:contains("Rec Specs")').length === 0 &&
            $('h1:contains("Zeal")').length === 0;

          if ($(".lens-bar-holder").length > 0) {
            $(".lens-bar-holder").remove();
          }

          if (
            ($('h1:contains("Prescription")').length > 0 ||
              $('h1:contains("Eyeglasses")').length > 0) &&
            excludePgs
          ) {
            $(
              '<div class="lens-bar-holder mx-0 mb-3"><div class="lens-bar d-block color-black px-2 size-12 text-center" style="background:  #FFEFC0; border-radius: 5px;"><b>Get $50 off your order of frames priced <br class="d-lg-none">$200 or more. </b></div></div>'
            ).prependTo("#prod-header-right");
          }
        } else {
          if (
            $("body").hasClass("fd-eye") &&
            fdFncs.pageType === "Product" &&
            !pgURLPath("/gunnar") &&
            !pgURLPath("/rec-specs") &&
            !pgURLPath("/ray-ban-stories") &&
            !pgURLPath("/ray-ban-meta")
          ) {
            addLensDiscountToRxEye(fdFncs.vars.discAmt, true);
            $("#ctl00_ContentPlaceHolderProductDisplay_hdnNewLensSelector").val(
              "true"
            );
          }
          if (
            $("body").hasClass("fd-eye") &&
            (pgURLPath("ray-ban-stories") || pgURLPath("ray-ban-meta")) &&
            fdFncs.vars.rbStoryDiscount !== undefined &&
            fdFncs.vars.rbStoryDiscount !== "" &&
            fdFncs.vars.rbStoryPromo !== undefined &&
            fdFncs.vars.rbStoryPromo !== ""
          ) {
            addLensDiscountToRxEye(
              fdFncs.vars.rbStoryDiscount,
              true,
              fdFncs.vars.rbStoryPromo
            );
          }
        }
  }
  prodDiscoBanner();


  //////////////////
  //for Rx Sun PDPs
  //////////////////

  function updateRxSunPolarizedDiscount() {
    if (
      (checkDate >= "241101" && checkDate <= "241103") ||
      (fdFncs.vars.isTest >= "241101" && fdFncs.vars.isTest <= "241103")
    ) {
      var brands = [
        "armani-exchange",
        "arnette",
        "brooks-brothers",
        "burberry",
        "coach",
        "costa",
        "dolce-gabbana",
        "emporio-armani",
        "giorgio-armani",
        "oakley",
        "polo",
        "ralph-lauren",
        "ray-ban",
        "tory-burch",
        "versace",
        "vogue",
      ];
      for (brand in brands) {
        if (
          pgURLPath(brands[brand]) &&
          $(
            "#ctl00_ContentPlaceHolderProductDisplay_ddlLensColor option:selected"
          )
            .text()
            .includes("Polarized")
        ) {
          addLensDiscountToRxSun(20, true, "discount in cart", false, true);
          break;
        } else if (pgURLPath("costa") || pgURLPath("oakley")) {
          $("#lens-price span").remove();
          $(".total-retail.lens, .total-retail.total").text("");
        }
      }
    }
  }
  updateRxSunPolarizedDiscount();

  function addLensDiscountToRxSun(amt, percentage, promoCode, noCode, polar) {
    //This function assumes the lens discount off
    var newSalePrice = 0;
    if (percentage && !noCode) {
      if (polar) {
        var bnr = "";
        if (!pgURLPath("oakley") && !pgURLPath("costa")) {
          bnr += "60% Off";
        }
        if ($(".lens-bar").length < 1) {
          $(
            '<div class="lens-bar background-green color-white d-flex justify-content-center mb-2"><div class="size-10">Polarized: ' +
            amt +
            "% Off Frame + " +
            bnr +
            " Lenses in Cart</div></div>"
          ).prependTo(".fd-rx-sun #prod-header-right");
        } else {
          $(".lens-bar").html(
            '<div class="size-10">Polarized: ' +
            amt +
            "% Off Frame + " +
            bnr +
            " Lenses in Cart</div>"
          );
        }
        if (pgURLPath("costa") || pgURLPath("oakley")) {
          if ($(".lens-discount-code").length < 1) {
            $(
              '<div class="align-right neg-marg"><div class="size-8 color-green weight-bold"><span class="lens-discount-code">' +
              promoCode +
              "</span></div></div>"
            ).appendTo("#prod-price-items");
          } else {
            $(".lens-discount-code").text(promoCode);
          }
        }
      } else {
        if ($(".lens-bar").length < 1) {
          $(
            '<div class="lens-bar background-green color-white d-flex justify-content-center mb-2"><div class="size-10">' +
            amt +
            '% Off Rx Lenses: <span class="ps-lens-promo transform-uppercase weight-bold">' +
            promoCode +
            "</span></div></div>"
          ).prependTo(".fd-rx-sun #prod-header-right");
        } else {
          $(".lens-bar").html(
            '<div class="size-10">' +
            amt +
            '% Off Rx Lenses: <span class="ps-lens-promo transform-uppercase weight-bold">' +
            promoCode +
            "</span></div>"
          );
        }
      }
      if (pgURLPath("costa") || pgURLPath("oakley")) {
        newSalePrice =
          (parseFloat(
            $(".total-sale.lens")
              .html()
              .match(/[\d\.]+/)
          ) *
            (100 - amt)) /
          100;
        $("#lens-price .size-11 span").remove();
        $("#lens-price .size-11").append(
          $('<span class="amt-disc">' + amt + "% Off</span>")
        );
      }
      clearInterval(checkIns);
      hasIns = null;
    } else if (percentage && noCode) {
      if ($(".lens-bar").length < 1) {
        $(
          '<div class="lens-bar background-green color-white d-flex justify-content-center mb-2"><div class="size-10">' +
          amt +
          '% Off Rx Lenses<span class="ps-lens-promo transform-uppercase weight-bold"></span></div>'
        ).prependTo(".fd-rx-sun #prod-header-right");
      }
      if (pgURLPath("costa") || pgURLPath("oakley")) {
        newSalePrice =
          (parseFloat(
            $(".total-sale.lens")
              .html()
              .match(/[\d\.]+/)
          ) *
            (100 - amt)) /
          100;
        $("#lens-price .size-11 span").remove();
        $("#lens-price .size-11").append(
          $('<span class="amt-disc">' + amt + "% Off</span>")
        );
      }
      clearInterval(checkIns);
      hasIns = null;
    } else {
      if ($(".lens-bar").length < 1) {
        $(
          '<div class="lens-bar background-green color-white d-flex justify-content-center"><div class="size-10">$' +
          amt +
          ' Off Polarized Rx Lenses <span class="ps-lens-promo transform-uppercase weight-bold"></span></div>'
        ).prependTo(".fd-rx-sun #prod-header-right");
      }
      if (pgURLPath("costa") || pgURLPath("oakley")) {
        newSalePrice =
          parseFloat(
            $(".total-sale.lens")
              .html()
              .match(/[\d\.]+/)
          ) - 30;
        $("#lens-price .size-11 span").remove();
        $("#lens-price .size-11").append(
          $('<span class="amt-disc">' + amt + "% Off</span>")
        );
      }
      clearInterval(checkIns);
      hasIns = null;
    }
    if (pgURLPath("costa") || pgURLPath("oakley")) {
      var lensRetailPrice = parseFloat(
        $(".total-sale.lens")
          .html()
          .match(/[\d\.]+/)
      ).toFixed(2),
        frameRetailPrice,
        frameSalePrice;
      //this becomes the old total sale above -
      $(".total-retail.lens").html("$" + lensRetailPrice);
      //discount this to the amount above (percentage or amt);
      $(".total-sale.lens").html("$" + newSalePrice.toFixed(2));
      //update Total at bottom - add frame price + lens price
      //combine Frame + Lens retail price
      if ($("#spanRetailPrice").text().trim() !== "") {
        frameRetailPrice = parseFloat(
          $("#spanRetailPrice")
            .text()
            .match(/[\d\.]+/)
        );
      } else {
        frameRetailPrice = parseFloat(
          $("#spanOurPrice")
            .text()
            .match(/[\d\.]+/)
        );
      }
      frameSalePrice = parseFloat(
        $("#spanOurPrice")
          .text()
          .match(/[\d\.]+/)
      );
      //combine frame + lens sale price.
      var totalRetail = (
        parseFloat(lensRetailPrice) + parseFloat(frameRetailPrice)
      ).toFixed(2),
        totalSale = (frameSalePrice + newSalePrice).toFixed(2);
      $("#prod-price-items .total-sale.total").html("$" + totalSale);
      $("#prod-price-items .total-retail.total").html("$" + totalRetail);
      clearInterval(checkIns);
      hasIns = null;
    }
  }
</script>