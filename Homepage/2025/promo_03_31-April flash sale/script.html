<script>
  const updateHeroBanner = () => {
    if (
      (checkDate >= "250407" && checkDate <= "250410") ||
      (fdFncs.vars.isTest >= "250407" && fdFncs.vars.isTest <= "250410")
    ) {
      let heroBanner = `
     <style>
  @media (min-width: 1400px) {
   .ct_text__overlay{
    width: auto;
    left: 34%;
   }
  }
  @media (min-width: 1200px) and (max-width: 1440px) {
   .ct_text__overlay{
    width: auto;
    left: 35%;
   }
  }

  @media (max-width: 1200px) {
    #firstHeroImg {
      padding: 0px !important;
      background-image: url('https://images.framesdirect.com/image/upload/v1742376979/homePage/FD_HP_FLASH_SALE_W14_M.jpg') !important;
    }
  }
</style>
<div class="heroBanner">
  <div class="ct_space">
    <div class="ct_banner ct_hero ">
      <a href="/sale" aria-label="sale">
        <div class="ct_assets__container">
          <picture class="ct_skeleton">
            <img
              src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAACCAYAAACUn8ZgAAAAAXNSR0IArs4c6QAAABNJREFUGFdj/Pzu8X8GHIARnyQANP0HiSbhWk8AAAAASUVORK5CYII="
              alt="structure image" />
          </picture>
          <picture class="ct_img">
            <img src="https://images.framesdirect.com/image/upload/v1742376979/homePage/FD_HP_FLASH_SALE_W14_D.jpg"
              fetchpriority="high"
              alt="The left is wearing Ray Ban rb7226 eyeglasses, other is Okaley Holbrook Ti Sunglasses" width="3840"
              height="1108" usemap="#image-map" />
          </picture>
          <map name="image-map">
            <area target="" alt="Ray Ban rb7226 eyeglasses" title="Ray Ban rb7226 eyeglasses"
              href="/ray-ban-rb7226-eyeglasses" coords="275,283,1176,565" shape="rect" />
            <area target="" alt="Okaley Holbrook Ti Sunglasses" title="Okaley Holbrook Ti Sunglasses"
              href="/oakley-holbrook-ti-sunglasses" coords="2621,271,3522,553" shape="rect" />
          </map>
        </div>
        <div class="ct_text__overlay ct_text__center ct_w__mob__100 ct_p__mob__0" id="firstHeroImg" >
          <h1
            class="ct_font__24 ct_font__desk__20 ct_font__mob_24 weight-normal ct_lh__sm ct_mb__mob__20 ct_mt__mob__30 d-none d-lg-block">
            Spring Flash Sale
          </h1>
          <div class="mt-4 mt-lg-0">
            <h1 class="ct_font__mob_32 ct_font__40 ct_font__desk__32 weight-bold ct_lh__sm ct_m__0 ct_mb__10">
              Up To 50% <br class="ct_desk__hide">Off Frames
            </h1>
            <span class="ct_font__mob_18 ct_font__18 ct_m__10 ct_font__desk__16">
              <b>250 + New styles added to clearance.</b><br>
              Donâ€™t wait! Sale ends April 10.
            </span>
            <div class="ct_font__48 ct_font__mob_48 ct_font__desk__42 align-self-center ct_p__0" style="line-height:1">
              +
            </div>
            <div>
              <h1 class=" ct_font__mob_32 ct_font__40 ct_font__desk__32 ct_lh__sm weight-bold ct_m__0">
                65% Off Lenses</span>
              </h1>
              <p class="ct_font__mob_18 ct_font__18 ct_m__10 ct_font__desk__20">
                Code:<b> EXTRA5</b>
              </p>
            </div>
          </div>
          <a href="/sale" class="ct_cta ct_cta__red ct_m__mob__10 ct_mb__mob__40"
            style="background-color:#AB2317; font-size:16px;">
            SAVE NOW
          </a>
        </div>
      </a>
    </div>
  </div>
</div>`;
      $(".heroBanner").replaceWith(heroBanner);
    } else if (
      (checkDate >= "250331" && checkDate <= "250406") ||
      (fdFncs.vars.isTest >= "250320" && fdFncs.vars.isTest <= "250406")
    ) {
      //hero slider promotion
      $(".heroBanner").wrap('<ul id="hero-slider"><li></li></ul>'); //Required to wrap around the existing heroBanner class for the first slide.
      $("#hero-slider").append(
        //This appends the second slide in the hero slider (second list item)
        `<li>
      <style>
  @media (min-width: 1200px) {
   .second_banner{
    width: auto;
    left: 38%;
   }
  }
  @media (max-width: 768px) {
    #secondHeroImg{
      padding: 0px !important;
      background-image: url('https://images.framesdirect.com/image/upload/v1742376981/homePage/FD_HP_MK_W14_M.jpg') !important;
    }
  }
     
  </style>

<div class="ct_space">
<div class="ct_banner ct_hero ct_mb__10">
  <a href="/michael-kors/brand" aria-label="michael kors sale">
    <div class="ct_assets__container">
      <picture class="ct_skeleton">
        <img
          src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAACCAYAAACUn8ZgAAAAAXNSR0IArs4c6QAAABNJREFUGFdjfHz7xH8GHIARnyQAIPkHDf57ZBAAAAAASUVORK5CYII="
          alt="structure image"
        />
      </picture>
      <picture class="ct_img">
        <img
          src="https://images.framesdirect.com/image/upload/v1742376980/homePage/FD_HP_MK_W14_D.jpg"
          fetchpriority="high"
          alt="The left is wearing Michael Kors mk4117u eyeglasses, other is wearing Michael Kors mk4104u sunglasses"
          width="3840"
          height="1107"
          usemap="#image-map2"
        />
      </picture>
      <map name="image-map2">
        <area
          target=""
          alt="Michael Kors mk4117u eyeglasses"
          title="Michael Kors mk4117u eyeglasses"
          href="/michael-kors-mk4117u-eyeglasses"
          coords="502,305,1339,572"
          shape="rect"
        />
        <area
          target=""
          alt="Michael Kors mk4104u sunglasses"
          title="Michael Kors mk4104u sunglasses"
          href="/michael-kors-mk4104u-sunglasses"
          coords="2476,290,3219,553"
          shape="rect"
        />
      </map>
    </div>
          <div class="ct_text__overlay ct_text__center ct_w__mob__100 ct_p__mob__0 second_banner" id="secondHeroImg">

    <div class="d-block d-lg-none">
        <img
          src="https://images.framesdirect.com/image/upload/v1536603243/logos/michael-kors-logo.svg"
          class="m-4"
        />
        <h1
          class="ct_font__mob_36 ct_font__40 ct_font__desk__32 weight-bold ct_lh__sm ct_m__0"
          style="margin: 0"
        >
          25% Off <br />
          All Frames
        </h1>
      </div>
      <div class="ct_mt__10">
        <div class="d-none d-lg-block">
          <h1
            class="ct_font__40 ct_font__desk__32 weight-bold ct_lh__sm ct_m__0"
            style="margin: 0"
          >
            25% Off <br />
            Michael Kors
          </h1>
        </div>
        <div
          class="ct_font__48 ct_font__mob_48 ct_font__desk__38 align-self-center ct_p__0"
          style="line-height: 1; margin: 0"
        >
          +
        </div>
        <div>
          <h1
            class="ct_font__mob_36 ct_font__40 ct_font__desk__32 ct_lh__sm weight-bold ct_m__0"
            style="margin: 0"
          >
            65% Off Lenses
          </h1>
          <p
            class="ct_font__mob_18 ct_font__18 ct_font__desk__18"
            style="margin-bottom: 25px !important; margin: 0"
          >
            Code:<b> EXTRA5</b>
          </p>
        </div>
      </div>
      <a
        href="/michael-kors/brand"
        class="ct_cta ct_cta__red ct_m__mob__10 ct_mb__mob__40"
        style="background-color: #ab2317; font-size: 18px"
      >
        SAVE NOW
      </a>
    </div>
  </a>
</div>
</div>

      </li>`
      );
    } else if (
      (checkDate >= "250320" && checkDate <= "250330") ||
      (fdFncs.vars.isTest >= "250320" && fdFncs.vars.isTest <= "250330")
    ) {
      let heroBanner = `
<style>
  .ct_text__overlay {
    background: #E3DAC9;
    background-image: url('https://images.framesdirect.com/image/upload/v1741341313/homePage/FD_HP_text_frame.png');
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    padding: 95px !important;
  }

  /* Mobile-specific styles */
  @media (max-width: 768px) {
    .ct_text__overlay {
      padding: 0px !important;
      background-image: url('https://images.framesdirect.com/image/upload/v1741605994/homePage/MOBILE_FRAME.png') !important;
    }
  }
</style>

<div class="ct_space">
  <div class="ct_banner ct_hero ct_mb__10">
    <a href="/email/spring-sale-dp" aria-label="spring-sale-dp">
      <div class="ct_assets__container">
        <picture class="ct_skeleton">
          <img
            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAACCAYAAACUn8ZgAAAAAXNSR0IArs4c6QAAABNJREFUGFdjfHz7xH8GHIARnyQAIPkHDf57ZBAAAAAASUVORK5CYII="
            alt="structure image"
          />
        </picture>
        <picture class="ct_img">
          <img
            src="https://images.framesdirect.com/image/upload/v1741341311/homePage/FD_HP_SPRING_PROMO.png"
            fetchpriority="high"
            alt="The left is wearing Ray-Ban RB5154 Clubmaster eyeglasses, other is wearing Burberry BE4337 Carnaby"
            width="3840"
            height="1107"
            usemap="#image-map"
          />
        </picture>
        <map name="image-map">
          <area
            target=""
            alt="Ray-Ban RB5154 Clubmaster"
            title="Ray-Ban RB5154 Clubmaster"
            href="ray-ban-rb5154-clubmaster-eyeglasses"
            coords="1688,338,2431,601"
            shape="rect"
          />
          <area
            target=""
            alt="Burberry BE4337 Carnaby"
            title="Burberry BE4337 Carnaby"
            href="/burberry-be4337-sunglasses"
            coords="2476,290,3219,553"
            shape="rect"
          />
        </map>
      </div>
      <div class="ct_text__overlay ct_text__center ct_w__mob__100 ct_p__mob__0 ml-md-3">
        <h1
          class="transform-uppercase ct_font__22 ct_font__desk__22 ct_font__mob_22 ct_lh__sm  ct_mt__mob__50 ct_mb__20"
          style="font-weight:300; margin: 0;">
          spring into savings
        </h1>
        <div class="ct_mt__10">
          <div>
            <h1
              class="transform-uppercase ct_font__mob_24 ct_font__24 ct_font__desk__20 weight-bold ct_lh__sm ct_m__0"
              style="margin: 0;">
              UP TO 50% OFF RAY-BAN,<br> OAKLEY, MICHAEL KORS </br>& MORE 
            </h1>
          </div>
          <div
            class="ct_font__48 ct_font__mob_32 ct_font__desk__38 align-self-center ct_p__0"
            style="line-height:1; margin: 0;">
            +
          </div>
          <div>
            <h1
              class="transform-uppercase ct_font__mob_24 ct_font__24 ct_font__desk__20 ct_lh__sm weight-bold ct_m__0"
              style="margin: 0;">
              65% OFF LENSES
            </h1>
            <p
              class="ct_font__mob_18 ct_font__18 ct_m__10 ct_font__desk__20"
              style="margin-bottom: 25px !important; margin: 0;">
              Code:<b> EXTRA5</b>
            </p>
          </div>
        </div>
        <a
          href="/email/spring-sale-dp"
          class="ct_cta ct_cta__red ct_m__mob__10 ct_mb__mob__40"
          style="background-color:#AB2317; font-size:18px;">
          SAVE NOW
        </a>
      </div>
    </a>
  </div>
</div>
`;
      $(".heroBanner").replaceWith(heroBanner);
    } else if (
      (checkDate >= "250313" && checkDate <= "250319") ||
      (fdFncs.vars.isTest >= "250313" && fdFncs.vars.isTest <= "250319")
    ) {
      let heroBanner = `
  <style>
      .ct_text__overlay {
    background: #C7D7D6;
    background-image: url('https://images.framesdirect.com/image/upload/v1741340543/homePage/FD_HP_text_EARLY_SPRING.png');
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    padding: 60px !important;
  }

@media screen and (min-width: 1270px) and (max-width: 1400px) {
  .ct_text__overlay {
    padding: 80px !important;
  }
}

  @media (max-width: 768px) {
    .ct_text__overlay {
      padding: 0px !important;
      background-image: url('https://images.framesdirect.com/image/upload/v1741607702/homePage/FD_EARLY_SPRING.png') !important;
    }
  }
        </style>

        <div class="ct_space">
          <div class="ct_banner ct_hero ct_mb__10">
            <a href="/email/spring-sale-dp" aria-label="spring-sale-dp">
              <div class="ct_assets__container">
                <picture class="ct_skeleton">
                  <img
                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAACCAYAAACUn8ZgAAAAAXNSR0IArs4c6QAAABNJREFUGFdjfPfu1X8GHIARnyQANYsHjTiCh7gAAAAASUVORK5CYII="
                    alt="structure image"
                  />
                </picture>
                <picture class="ct_img">
                  <img
                    src="https://images.framesdirect.com/image/upload/v1741340543/homePage/FD_HP_EARLY_SPRING_PROMO.png"
                    fetchpriority="high"
                    alt="Models wearing Versace VE2168 sunglasses,Polo PH1147 eyeglasses and Burberry BE2073 eyeglasses"
                    width="1440"
                    height="415"
                    usemap="#image-map"
          
                  />
                </picture>
                <map name="image-map">
                  <area
                    target=""
                    alt="Versace VE2168 sunglasses"
                    title="Versace VE2168 sunglasses"
                    href="/versace-ve2168-prescription-sunglasses"
                    coords="575,206,740,124"
                    shape="rect"
                  />
                  <area
                    target=""
                    alt="Polo PH1147 eyeglasses"
                    title="Polo PH1147 eyeglasses"
                    href="/polo-ph1147-eyeglasses"
                    coords="872,220,1136,119"
                    shape="rect"
                  />
                  <area
                    target=""
                    alt="Burberry BE2073"
                    title="Burberry BE2073"
                    href="/burberry-be2073-eyeglasses?color=469971"
                    coords="1190,219,1439,68"
                    shape="rect"
                  />
                </map>
              </div>
              <div class="ct_text__overlay ct_text__center ct_w__mob__100 ct_p__mob__30">
                <h1
                  class="transform-uppercase ct_font__24 ct_font__desk__22 ct_font__mob_22 ct_lh__sm  ct_mt__mob__50 ct_mb__20"
                  style="font-weight:300; margin: 0;">
                  EARLY SPRING SAVINGS
                </h1>
                <div class="ct_mt__10">
                  <div>
                    <h1
                      class="transform-uppercase ct_font__mob_22 ct_font__28 ct_font__desk__22 weight-bold ct_lh__sm ct_m__0"
                      style="margin: 0;">
                      UP TO 50% OFF VERSACE,<br /> BURBERRY & MORE
                    </h1>
                  </div>
                  <div
                    class="ct_font__48 ct_font__mob_32 ct_font__desk__38 align-self-center ct_p__0"
                    style="line-height:1; margin: 0;">
                    +
                  </div>
                  <div>
                    <h1
                      class="transform-uppercase ct_font__mob_22 ct_font__28 ct_font__desk__22 ct_lh__sm weight-bold ct_m__0"
                      style="margin: 0;">
                      65% OFF LENSES
                    </h1>
                    <p
                      class="ct_font__mob_18 ct_font__18 ct_m__10 ct_font__desk__20"
                      style="margin-bottom: 25px !important; margin: 0;">
                      Code:<b> EXTRA5</b>
                    </p>
                  </div>
                </div>
                <a
                  href="/email/spring-sale-dp"
                  class="ct_cta ct_cta__red ct_m__mob__10 ct_mb__mob__40"
            style="background-color:#AB2317; font-size:18px;">
                  SAVE NOW
                </a>
              </div>
            </a>
          </div>
        </div>`;
      $(".heroBanner").replaceWith(heroBanner);
    } else if (
      (checkDate >= "250224" && checkDate <= "250312") ||
      (fdFncs.vars.isTest >= "250224" && fdFncs.vars.isTest <= "250312")
    ) {
      let heroBanner = `

          <div class="ct_space">
            <div class="ct_banner ct_hero ct_mb__10">
              <a
                href="/sale"
                aria-label="email-flash-sale"
              >
                <div class="ct_assets__container">
                  <picture class="ct_skeleton">
                    <img
                     src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAACCAYAAACUn8ZgAAAAAXNSR0IArs4c6QAAABNJREFUGFdjfPfu1X8GHIARnyQANYsHjTiCh7gAAAAASUVORK5CYII="     alt="structure image"
                    />
                  </picture>
                  <picture class="ct_img">
            <img
              src="https://images.framesdirect.com/image/upload/v1739972990/homePage/HP_EA_D_1920.png"
              fetchpriority="high"
              alt="The left is wearing Guardian eyeglasses, other is wearing Guess gu2904 eyeglasses"
              width="2160"
              height="623"
              usemap="#image-map"
              id="hero_img"
            />
          </picture>
          <map name="image-map">
            <area
              target=""
              alt="Guardian eyeglasses"
              title="Guardian eyeglasses"
              href="/xxl-guardian-eyeglasses?color=2"
              coords="1043,109,1382,275"
              shape="rect"
            />
            <area
              target=""
              alt="Guess gu2904 eyeglasses"
              title="Guess gu2904 eyeglasses"
              href="/guess-gu2904-eyeglasses?color=4"
              coords="1501,231,1808,354"
              shape="rect"
            />
          </map>
                </div>
          <div
            class="ct_text__overlay ct_text__center ct_w__mob__100 ct_p__mob__0"
            style="background: #D4BDAE; width: 36%"
          >
            <h1
              class="transform-uppercase ct_font__32 ct_font__desk__30 ct_font__mob_26 ct_lh__sm ct_mb__mob__20 ct_mt__mob__50 ct_mb__20" style="font-weight:300"
            >
              Luxury style at a steal
            </h1>
            <div
              class="ct_mt__10"
            >
              <div>
                <h1
                  class="transform-uppercase ct_font__mob_26 ct_font__32 ct_font__desk__32 weight-bold ct_lh__sm ct_m__0"
                >
                  UP TO 50% OFF FRAMES
                </h1>
              </div>
              <div
                class="ct_font__48 ct_font__mob_32 ct_font__desk__38 align-self-center ct_p__0" style="line-height:1"
              >
                +
              </div>
              <div>
                <h1
                  class="transform-uppercase ct_font__mob_26 ct_font__32 ct_font__desk__32 ct_lh__sm weight-bold ct_m__0"
                >
                 65% OFF LENSES
                </h1>
                <p
                  class="ct_font__mob_18 ct_font__18 ct_m__10 ct_font__desk__24"
                  style="margin-bottom: 25px !important"
                >
                  <b id="promoCode" >Code: EXTRA5</b>
                </p>
              </div>
            </div>
            <a
              href="/sale"
              class="ct_cta ct_cta__red ct_m__mob__10 ct_mb__mob__40"
              style="background-color:#AB2317"
              >SAVE NOW</a
            >
          </div>
        </a>
      </div>
    </div>
       `;
      $(".heroBanner").replaceWith(heroBanner);
    } else {
    }
  };

  const updateSecondBanner = () => {
    let firstInsuranceBanner = document.getElementById("firstInsuranceBanner");
    if (
      (checkDate >= "250313" && checkDate <= "250315") ||
      (fdFncs.vars.isTest >= "250313" && fdFncs.vars.isTest <= "250315")
    ) {
      firstInsuranceBanner.innerHTML = `
      <div
      class="d-flex flex-wrap mb-4 mx-3 mt-3 mt-lg-5"
      style="background-color: #D3BDAF;"
    >
      <div
        class="img-block col-12 col-lg-5 d-flex justify-content-center align-items-center order-1 order-lg-0"
        style="
          background: url('https://images.framesdirect.com/image/upload/v1741340543/homePage/FD_HP_SECONDARY_BANNER_FSA.png')
            no-repeat center center / auto 100%;
          max-height: 250px;
          min-height: 175px;
        "
      ></div>
      <div
        class="copy-block d-flex flex-wrap text-center text-lg-left col-12 col-lg-7 p-4 ml-desk-4 justify-content-center align-items-center justify-content-lg-start"
      >
        <p
          class="d-none d-md-block col-12 size-22 mt-3 mb-3 mb-lg-0 px-0 px-sm-3"
          style="line-height: 1.2"
        >
          <span class="weight-bold">DON'T LET YOUR FSA <br class="ct_desk__hide"> DOLLARS DISAPPEAR!</span>

        </p>
        <p
          class="ct_desk__hide col-12 size-22 mt-3 mb-3 mb-lg-0 px-0 px-sm-3"
          style="line-height: 1.2"
        >
       <span class="weight-bold">DON'T LET YOUR FSA <br class="ct_desk__hide"> DOLLARS DISAPPEAR!</span>
        </p>
        <div class="col-12 col-lg-11 size-13 weight-light mt-4 p-0 pl-lg-3">
         Redeem your vision insurance, <b>including FSA benefits before they <br class="d-none d-md-block">expire on March 15.</b>
        </div>
        <div class="text-center pl-3 d-flex flex-column flex-lg-row mb-lg-3 ">
          <a
            href="/collections/fsa-hsa-eligible-eyewear-dp"
            class="btn-cta nowrap mt-4"
            style="background: #cd0000; color: #fff !important; border: 0"
            >Shop Now</a
          >
          <a
            href="/knowledge-center/do-you-have-flex-spending-dollars"
            class="btn-cta nowrap mt-2 mt-lg-4 ml-lg-5"
            style="background: #000; color: #fff !important; border: 0"
            >FIND OUT MORE</a
          >
        </div>
      </div>
    </div>

        `;
    } else if (
      (checkDate >= "250220" && checkDate <= "250230") ||
      (fdFncs.vars.isTest >= "250220" && fdFncs.vars.isTest <= "250230")
    ) {
      firstInsuranceBanner.innerHTML = `
<div
  class="d-flex flex-wrap mb-4 mx-3 mt-3 mt-lg-5"
  style="background-color: #83A3A5; color: white" height: 252px;
>
  <div
    class="img-block col-12 col-lg-5 d-flex justify-content-center align-items-center order-1 order-lg-0"
    style="
      background: url('https://images.framesdirect.com/image/upload/v1741341309/homePage/FD_HP_SECONDARY_BANNER_NEW_ARRIVALS.png')
        no-repeat center center / auto 100%;
      max-height: 252px;
      min-height: 167px;
    "
  ></div>
  <div 
    class="copy-block d-flex flex-wrap text-center text-lg-left col-12 col-lg-7 p-4 ml-desk-4 justify-content-center align-items-center justify-content-lg-start"
    style="color: white"
  >
    <p
      class="d-none d-md-block col-12 size-22 mt-3 mb-3 mb-lg-0 px-0 px-sm-3"
      style="line-height: 1.2; color: white"
    >
      <span class="weight-bold">INTRODUCING   <br class="d-block d-md-none">  TIFANNY & CO.</span>
    </p>
    <p
      class="d-block d-md-none col-12 size-22 mt-3 mb-3 mb-lg-0 px-0 px-sm-3"
      style="line-height: 1.2; color: white"
    >
      <span class="weight-bold">INTRODUCING <br class="d-block d-md-none"> TIFANNY & CO.</span>
    </p>
   <div class="col-12 col-lg-11 size-12 weight-light p-0 pl-lg-3 mt-3" style="color: white;margin-bottom: 40px;">
      New arrivals! Weâ€™re excited to feature  Tiffany &amp; Co. styles.
    </div>
    <div class="text-center pl-3 d-flex flex-column flex-lg-row pb-2">
      <a
        href="/collections/fsa-hsa-eligible-eyewear-dp"
        class="btn-cta nowrap mt-4"
        style="background: #AB2317; color: #fff !important; border: 0"
        >SHOP TIFFANY</a
      >
      <a
        href="/collections/new-arrivals-dp"
        class="btn-cta nowrap mt-2 mt-lg-4 ml-lg-5"
        style="background: #000; color: #fff !important; border: 0"
        >SHOP NEW ARRIVALS</a
      >
    </div>
  </div>
</div>


        `;
    } else if (
      (checkDate >= "250303" && checkDate <= "250312") ||
      (fdFncs.vars.isTest >= "250303" && fdFncs.vars.isTest <= "250312")
    ) {
      firstInsuranceBanner.innerHTML = `
<div class="d-flex flex-wrap mb-4 mx-3 mt-3 mt-lg-5 align-items-stretch" style="background-color: #000000; position: relative;">
  <a href="/diesel/brand" class="d-flex flex-wrap w-100" style="color: inherit; text-decoration: none">
    <div class="img-block col-12 col-lg-6 order-1 order-lg-0 d-flex p-0">
      <img 
        src="https://images.framesdirect.com/image/upload/v1740750006/homePage/FD_HP_Secondary_Banner_DIESEL.jpg" 
        alt="Diesel Eyewear" 
        class="img-fluid w-100 h-100 object-fit-cover"
      />
    </div>
    <div class="copy-block d-flex flex-wrap text-center text-lg-left col-12 col-lg-6 p-4 ml-desk-4 justify-content-center align-items-center justify-content-lg-start align-items-lg-start" style="color:white">
      <p class="pl-4 pt-4 col-12 size-24 my-2 my-xl-1 weight-light" style="line-height: 1.4">
        INTRODUCING <br class="d-block d-lg-none" /><strong>DIESEL EYEWEAR:</strong><br>
        <span class="size-7"> Bold frames, fearless attitude. </span>
      </p>
      <div class="pt-4 text-center pl-0 pl-lg-3 pb-2 ml-2 d-flex flex-column flex-lg-row">
        <span 
          class="nowrap mt-4" 
          style="
            display: inline-block;
            padding: .5em 1.5em;
            font-family: inherit;
            cursor: pointer;
            background: #CC0000;
            line-height: normal;
            text-transform: uppercase;
            text-align: center;
            vertical-align: baseline;
            font-size: 120%;
            color: #fff !important;
            border-radius: 4px;
            font-weight: 600 !important;
          "
        >
          Shop Now
        </span>
      </div>
    </div>
  </a>
</div>

<style>
  .img-block img {
    object-fit: cover; 
  }
</style>

        `;
    } else if (
      (checkDate >= "241210" && checkDate <= "241229") ||
      (fdFncs.vars.isTest >= "241210" && fdFncs.vars.isTest <= "241229")
    ) {
      let firstInsuranceBanner = `
        <div
          id="firstInsuranceBanner"
          class="d-flex flex-wrap mx-3 mt-3 mt-lg-5 mb-4 px-0 order weight-medium"
          style="min-height: 176px; background: #aab9c0 !important; color: #2d3547"
        >
          <div
            class="order-2 order-lg-1 col-12 col-lg-4 d-flex flex-column justify-content-center align-items-center"
          >
            <p class="size-14 text-center color-black">
              <span class="weight-bold">$40 off</span> on sunglasses $180+ <br />
              <span class="weight-bold">$80 off</span> on sunglasses $350+ <br />
              <a
                href="/email/holiday-deals-dp"
                class="btn-cta nowrap mt-4 d-none d-lg-block ml-5"
                style="
                  background: #cd0000;
                  color: #fff !important;
                  border: 0;
                  padding: 10px 20px;
                  width: 135px;
                "
                >SAVE NOW
                </a>
            </p>
          </div>
          <div
            class="order-1 order-lg-2 col-12 col-lg-4 position-relative text-center d-flex flex-column align-items-center justify-content-center pt-0 py-0 px-0"
            style="
              min-height: 200px;
              background: #aab9c0
                url('https://images.framesdirect.com/image/upload/v1732541066/homePage/FD_Secondary_HP_promo_SUNGLASSES.png')
                no-repeat bottom center/auto 200px;
            "
          ></div>
          <div
            class="order-3 order-lg-3 col-12 col-lg-4 text-center d-flex flex-column align-items-center align-items-lg-start justify-content-center pt-0 py-2 px-0"
          >
            <p class="size-14 text-center color-black">
              Combinable with <br />
              <span class="weight-bold">
                Up to 60% off lenses including <br />
                Costa & Oakley sun lenses </span
              ><br />
              <a
                href="/email/holiday-deals-dp"
                class="btn-cta mt-3 d-lg-none"
                style="background: #cd0000; min-width: 130px; bottom: 10px"
                >SAVE NOW</a
              >
            </p>
          </div>
        </div>
        `;
      $("#firstInsuranceBanner").replaceWith(firstInsuranceBanner);
    } else {
      /* DEFAULT BANNER IS STATIC IN HTML */
    }
  };

  const updateSecondInsuranceBanner = () => {
    if (
      (checkDate >= "250101" && checkDate <= "250202") ||
      (fdFncs.vars.isTest >= "250101" && fdFncs.vars.isTest <= "250202")
    ) {
      let secondInsuranceBanner = ` <div
      class="d-flex flex-wrap mb-4 mx-3 mt-3 mt-lg-5"
      style="background-color: #D3D7E0;"
    >
      <div
        class="img-block col-12 col-lg-5 d-flex justify-content-center align-items-center order-1 order-lg-0"
        style="
          background: url('https://images.framesdirect.com/image/upload/v1734014789/homePage/FD_Secondary_HP_JAN_2025.png')
            no-repeat center center / auto 100%;
          max-height: 250px;
          min-height: 200px;
        "
      ></div>
      <div
        class="copy-block d-flex flex-wrap text-center text-lg-left col-12 col-lg-7 p-4 ml-desk-4 justify-content-center align-items-center justify-content-lg-start"
      >
        <p
          class="d-none d-md-block col-12 size-25 mt-3 mb-3 mb-lg-0 px-0 px-sm-3"
          style="line-height: 1.2"
        >
          RENEWED <span class="weight-bold">2025 VISION BENEFITS?</span>
        </p>
        <p
          class="d-block d-md-none col-12 size-25 mt-3 mb-3 mb-lg-0 px-0 px-sm-3"
          style="line-height: 1.2"
        >
          <span class="weight-bold">RENEWED 2025</span><br>VISION BENEFITS?
        </p>
        <div class="col-12 col-lg-11 size-13 weight-light">
          Time for a reset. Spend your fresh FSA/HSA dollars today!
        </div>
        <div class="text-center pl-3 d-flex flex-column flex-lg-row">
          <a
            href="/collections/fsa-hsa-eligible-eyewear-dp"
            class="btn-cta nowrap mt-4"
            style="background: #cd0000; color: #fff !important; border: 0"
            >Shop Now</a
          >
          <a
            href="/knowledge-center/do-you-have-flex-spending-dollars"
            class="btn-cta nowrap mt-2 mt-lg-4 ml-lg-5"
            style="background: #000; color: #fff !important; border: 0"
            >FIND OUT MORE</a
          >
        </div>
      </div>
    </div>
        `;
      $("#secondInsuranceBanner").replaceWith(secondInsuranceBanner);
    } else if (
      (checkDate >= "241210" && checkDate <= "241229") ||
      (fdFncs.vars.isTest >= "241210" && fdFncs.vars.isTest <= "241229")
    ) {
      let secondInsuranceBanner = ` <div
      class="d-flex flex-wrap mb-4 mx-3 mt-3 mt-lg-5"
      style="background-color: #d9c6ba"
    >
      <div
        class="img-block col-12 col-lg-5 d-flex justify-content-center align-items-center order-1 order-lg-0"
        style="
          background: url('https://images.framesdirect.com/image/upload/v1732541191/homePage/FD_Secondary_HP_Insurance.jpg')
            no-repeat center center / auto 100%;
          max-height: 270px;
          min-height: 200px;
        "
      ></div>
      <div
        class="copy-block d-flex flex-wrap text-center text-lg-left col-12 col-lg-7 p-4 ml-desk-4 justify-content-center align-items-center justify-content-lg-start align-items-lg-start"
      >
        <p
          class="col-12 size-21 my-2 my-xl-1 weight-light px-0 px-sm-3"
          style="line-height: 1.2"
        >
          SPEND IT BEFORE YOU LOSE IT! <br class="d-none d-lg-block" />
          <span class="weight-bold">BENEFITS EXPIRE ON DECEMBER 31</span>
        </p>
        <div class="col-12 col-lg-11 size-13 mt-3 weight-light">
          <strong>Donâ€™t let your FSA/HSA go to waste! </strong>Use them before the
          new year to get new eyeglasses, prescription sunglasses, or contact
          lenses.
        </div>
        <div class="text-center ml-2 d-flex flex-column flex-lg-row">
          <a
            href="/collections/fsa-hsa-eligible-eyewear-dp"
            class="btn-cta nowrap mt-4"
            style="background: #cd0000; color: #fff !important; border: 0"
            >Shop Now</a
          >
          <a
            href="/knowledge-center/do-you-have-flex-spending-dollars"
            class="btn-cta nowrap mt-2 mt-lg-4 ml-lg-5"
            style="background: #000; color: #fff !important; border: 0"
            >FIND OUT MORE</a
          >
        </div>
      </div>
    </div>
        `;
      $("#secondInsuranceBanner").replaceWith(secondInsuranceBanner);
    }
  };
  var bannerSlider = "";
  function initBannerSlider() {
    if (
      bannerSlider.lightSlider &&
      typeof bannerSlider.destroy === "function"
    ) {
      bannerSlider.destroy();
    }
    bannerSlider = $("#light-slider").lightSlider({
      item: 9,
      auto: true,
      slideMove: 3,
      loop: true,
      autoWidth: false,
      pauseOnHover: true,
      easing: "cubic-bezier(0.25, 0, 0.25, 1)",
      speed: 1000,
      pause: 3000,
      slideMargin: 5,
      responsive: [
        {
          breakpoint: 1400,
          settings: {
            item: 6,
          },
        },
        {
          breakpoint: 1080,
          settings: {
            item: 4,
          },
        },
        {
          breakpoint: 500,
          settings: {
            item: 3,
          },
        },
      ],
      onSliderLoad: function (el) {
        $("#light-slider").css("opacity", 1);
      },
    });
  }
  var heroSlider = "";
  function initHeroSlider() {
    if (heroSlider.lightSlider && typeof heroSlider.destroy === "function") {
      heroSlider.destroy();
    }
    heroSlider = $("#hero-slider").lightSlider({
      item: 1,
      loop: true,
      auto: true,
      autoWidth: false,
      easing: "cubic-bezier(0.25, 0, 0.25, 1)",
      speed: 1000,
      pauseOnHover: true,
      pager: false,
      pause: 8000,
      onSliderLoad: function (el) {
        $("#hero-slider").css("opacity", 1);
      },
      onBeforeSlide: function (el) {
        let videos = document.querySelectorAll("#hero-slider video");
        videos.forEach((video) => {
          video.pause();
          video.currentTime = 0;
        });
      },

      onAfterSlide: function (el) {
        let videos = document.querySelectorAll("#hero-slider video");
        videos.forEach((video) => {
          video.play();
          video.currentTime = 0;
        });
      },
    });
  }

  $(function () {
    updateHeroBanner();
    updateSecondBanner();
    updateSecondInsuranceBanner();

    if (checkDate > "240508" && checkDate < "240514") {
      $("#promoSale").removeClass("d-none").addClass("d-flex");
    }
    if (
      checkDate > "240403" &&
      checkDate < "240415" &&
      getCookie("fdRecognized") !== undefined
    ) {
      var discAmt = "25";
      if (checkDate > "240412") {
        discAmt = "30";
      }
      $(".heroBanner").replaceWith(
        '<div class="heroBanner position-relative img-flex extended d-flex"><a href="/email/customer-appreciation-dp" class="d-block"><video autoplay muted loop playsinline disablePictureInPicture width="100%" class="d-block"><source src="https://images.framesdirect.com/video/upload/v1711381956/homePage/FD_HP_CUW.mp4" type="video/mp4" /></video></a><div class="text-overlay col-12 col-xl-3 d-flex"><div class="home-promo col-12 d-flex flex-column align-items-center justify-content-center"><div class="size-16 color-white">Private Week is live<div class="weight-bold">Offer ends April 14th</div></div><div class="align-items-center pt-xl-3 pb-xl-5 py-4"><h1 class="size-50 mb-0">' +
          discAmt +
          '% OFF</h1><div class="size-18 weight-bold transform-none mt-0">Ray-Ban, Oakley, and more</div><div class="size-14 weight-normal transform-none mt-3">Combinable with 60% off lenses.<br class="d-none d-sm-block"> Enjoy your exclusive savings at checkout.</div></div><a href="/email/customer-appreciation-dp" class="btn-cta mx-5 px-5 py-2 d-inline-block" style="background: #bd0000; color: #fff !important;">Save Now</a></div></div></div>'
      );
    } else if (checkDate > "240403" && checkDate < "240415") {
      $(".heroBanner").replaceWith(
        '<div class="heroBanner position-relative img-flex extended d-flex"><a href="#" class="d-block"><video autoplay muted loop playsinline disablePictureInPicture width="100%" class="d-block"><source src="https://images.framesdirect.com/video/upload/v1711381956/homePage/FD_HP_CUW.mp4" type="video/mp4" /></video></a><div class="text-overlay col-12 col-xl-3 d-flex"><div class="home-promo col-12 d-flex flex-column align-items-center justify-content-center"><div class="img-flex mt-2" style="margin-bottom: 30px;"><img src="https://images.framesdirect.com/image/upload/v1711633428/homePage/FD_CUW_Herobanner_Mobile.png" width="581" height="437" alt="Private Week is Live" style="max-width: 200px;"></div><div class="color-white size-16">Sign up or sign in to access<br class="d-none d-sm-block"> your exclusive offer ending April 14th.</div><div class="align-items-center justify-content-center pt-4"><a href="#" id="btn-sign-up" class="btn-cta mx-5 ml-md-0 mr-md-5 px-5 py-2 d-inline-block" style="background: #bd0000; color: #fff !important;">SIGN UP</a> <a href="#" id="btn-sign-in" class="btn-cta signIn mx-5 mr-md-0 ml-md-5 px-5 py-2 d-inline-block" style="background: #fff; color: #000 !important;">SIGN IN</a></div></div></div>'
      );
      $("#btn-sign-up").on("click", function () {
        $("#footer-newsletter-submit").click();
      });
      $(document).on("click", "a.signIn", function (e) {
        e.preventDefault();
        $("#ctl01_lnkNewLogin a").click();
      });
    }
    if (checkDate > "240430" && checkDate < "240508") {
      $("#promoSale").removeClass("display-none");
    }
    if (checkDate > "231108" && checkDate < "231116") {
      $("#email-signup").removeClass("display-none");
    }
    $("#polarizedSale").on("click", function () {
      window.location.href = "/sale/polarized-dp";
    });
    $(
      "#saleBlock > div, #brand-callout, #text-overlay, #promoSale, #cyberSale"
    ).on("click", function () {
      let $this = $(this),
        linkLoc = $this.find("a").attr("href");
      window.location.href = linkLoc;
    });
    $("#email-signup").on("click", function () {
      $("#footer-newsletter-submit").click();
    });
    if (checkDate > "230109") {
      $("#saleBlock").removeClass("d-flex").addClass("d-none");
    }
    if (checkDate > "231130" && checkDate < "240101") {
      $("#FSABar h2").html(
        "Use Your FSA Dollars<br>Before They Expire December 31st"
      );
      $("#FSABar p").html(
        "Many Flexible Spending Accounts expire on December 31st, but yours don't have to go to waste. Get new eyeglasses, prescription sunglasses, readers, or contact lenses before the new year."
      );
      $("#FSABar").insertBefore("#rfk-hp-custFaves");
    } else if (checkDate > "231231" && checkDate < "240201") {
      $("#FSABar h2").html("New Year, New FSA Dollars to Use!");
      $("#FSABar p").html(
        "Many Flexible Spending Accounts renewed January 1st. It's the perfect time to get new eyeglasses, prescription sunglasses, readers, or contact lenses."
      );
      $("#FSABar a.btn-cta")
        .clone()
        .text("FIND OUT MORE")
        .attr(
          "href",
          "https://www.framesdirect.com/knowledge-center/do-you-have-flex-spending-dollars"
        )
        .attr(
          "style",
          "background: #000 !important; color: #fff !important; margin-left: 20px !important;"
        )
        .insertAfter("#FSABar a.btn-cta");
    } else if (checkDate > "240304" && checkDate < "240316") {
      $("#FSABar h2").html("Your FSA Dollars deadline is approaching!");
      $("#FSABar p").html(
        "With many Flexible Spending Accounts expiring on March 15th, it's the perfect time to get new prescription eyeglasses, sunglasses, readers, or contacts lenses."
      );
    } else {
      $("#FSABar h2").html("We Accept FSA &amp; HSA");
      $("#FSABar p").html(
        "Did you know that you can use your flexible spending account (FSA) or health savings account (HSA) dollars to purchase prescription eyeglasses, prescription sunglasses, and prescription contact lenses? These funds can be used whether you have vision insurance or not. And if you use your flex spending or HSA debit card, you won't have to submit a reimbursement form to your insurance provider!"
      );
    }
    $(".heroBanner").css("opacity", 1);
    if (checkDate > "221205" && checkDate < "221209") {
      $("#home-promo > a").attr("href", "/email/holiday-deals-dp");
    }
    $("#TransitionsBar").on("click", function () {
      window.location.href = "/eyeglasses";
    });
    $("#FSABar").on("click", function () {
      window.location.href = "/collections/fsa-hsa-eligible-eyewear-dp";
    });

    $("#klarna").on("click", function () {
      window.location.href = "/knowledge-center/shopping-with-Klarna";
    });
    $("#promoBanner").show();

    if (checkDate > "240205" && checkDate < "240215") {
      $("#cyberSale").removeClass("display-none");
    }
    if (checkDate > "240311" && checkDate < "240315") {
      $("#cyberSale").replaceWith(
        '<div id="cyberSale" class="d-flex flex-wrap px-0 mb-4 weight-medium order" style="background: #D1D7D0; color: #535752;"><div class="col-12 col-xl-4 text-center d-flex flex-column align-items-center justify-content-center pt-0 py-2 px-0 img-flex"><p class="size-20 my-1 mt-0 mt-xl-0 weight-bold" style="line-height: 1.3;">Spring Break Sale</p><p class="size-40 weight-extra-bold my-xl-0 mt-2 mb-0">20% OFF</p><p class="size-20 my-1 mt-0 mt-xl-0 weight-bold" style="line-height: 1.3;">Frames from Versace,<br>Burberry, & more</p></div><div class="col-12 col-xl-4 text-center d-flex flex-column align-items-center justify-content-center pt-0 py-0 px-0 img-flex"><div class="my-0 my-lg-4 my-xl-0 px-2" style="max-width: 100%; width: 100%;"><img src="https://images.framesdirect.com/image/upload/v1709886560/homePage/FD_promo_Homepage_Spring_Break_Photo.png" alt="Spring Break Savings"></div><a href="/email/spring-break-sun-dp" class="btn-cta" style="background: #cd0000; border: 0; color: #fff !important;">SAVE NOW</a></div><div class="col-12 col-xl-4 d-flex flex-column justify-content-center align-items-center pb-4 pt-0 py-xl-5"><div class="size-20 pt-xl-0">Combinable with</div><p class="size-20 weight-extra-bold my-xl-2 mt-4 mb-0">60% OFF LENSES</p><a class="btn-cta py-2 px-5 transform-uppercase mt-3" href="/email/spring-break-sun-dp" style="background:#000; color: #fff !important; border: 0 !important; min-width: 250px;">SAVE NOW</a></div></div>'
      );
    }
    initHeroSlider();
    if (fdFncs.custType !== undefined) {
      if (fdFncs.custType === "preferred" || fdFncs.custType === "vip") {
        $(".ct_hero").html($(".ct_hero").html().replace("60", "65"));
      }
    }
    if (window.location.href.toLowerCase().includes("upto50")) {
      $(".home-promo h1").replaceWith(
        '<h1>Up to 50% Off<div class="hp-promo-sm weight-normal transform-none">80+ Designer Brands</div></h1>'
      );
    }
  });

  function hpHero() {
    if ($(".heroBanner > a img").length < 1) {
      $(".heroImg").on("load", function () {
        $(".heroBanner").css("min-height", "inherit");
        $(".heroImg").rwdImageMaps();
      });
    }
    $(".text-overlay").css("opacity", 1);
  }
  $(window)
    .on("load", function () {
      initHeroSlider();
      $(".heroBanner").css("min-height", "auto");
      $(
        '<li class="larger-brand"><a href="/dolce-gabbana/brand"><img src="https://images.framesdirect.com/image/upload/h_40,c_fit/v1531418607/logos/dolce-gabbana-logo.svg" width="300" height="29" alt="Dolce &amp; Gabbana Eyewear"></a></li><li><a href="/coach/brand"><img src="/images/customerimages/global/logos/coach-logo.svg" width="300" height="121" alt="Coach"></a></li><li class="larger-brand"><a href="/giorgio-armani/brand"><img src="https://images.framesdirect.com/image/upload/h_40,c_fit/v1626742482/logos/giorgio-armani-logo.svg" width="300" height="29" alt="Giorgio Armani"></a></li><li><a href="/wiley-x/brand"><img src="https://images.framesdirect.com/image/upload/v1707250152/logos/WX_logo_stacked_black.svg" width="110" height="70" alt="Wiley X Eyewear"></a></li><li class="larger-brand"><a href="/michael-kors/brand"><img src="/images/customerimages/global/logos/michael-kors-logo.svg" width="300" height="28" alt="Michael Kors"></a></li><li class="larger-brand"><a href="/tory-burch/brand"><img src="/images/customerimages/global/logos/tory-burch-logo.png" width="200" height="70" alt="Tory Burch"></a></li><li><a href="/hugo-boss/brand"><img src="/images/customerimages/global/logos/hugo-boss-logo.svg" width="300" height="110" alt="Hugo Boss"></a></li><li><a href="/polo/brand"><img src="https://images.framesdirect.com/image/upload/h_33/v1542731790/logos/polo-logo.svg" width="300" height="117" alt="Polo"></a></li><li><a href="/nike/brand"><img src="https://images.framesdirect.com/image/upload/h_33/v1591982175/logos/nike-logo.svg" width="300" height="105" alt="Nike"></a></li>   <li><a href="/shuron/brand"><img src="https://images.framesdirect.com/image/upload/w_103/v1630593191/logos/shuron-logo.png" width="103" height="24" alt="Shuron"></a></li><li><a href="/carrera/brand"><img src="https://images.framesdirect.com/image/upload/h_33/v1591982126/logos/carrera-logo.svg" width="300" height="60" alt="Carrera"></a></li><li><a href="/guess/brand"><img src="https://images.framesdirect.com/image/upload/h_33/v1591982146/logos/guess-logo.svg" width="300" height="53" alt="Guess"></a></li><li class="larger-brand"><a href="/ralph-lauren/brand"><img src="https://images.framesdirect.com/image/upload/h_40/v1531417371/logos/ralph-lauren-logo.svg" width="300" height="22" alt="Ralph Lauren"></a></li>'
      ).appendTo("#light-slider");

      if ($(window).width() < 1300) {
        var array = $("#brand-showcase #light-slider li:not(.clone) a");

        for (var i = array.length; i >= 0; i--) {
          if (i % 2 == 0) {
            $(array[i - 1])
              .addClass("mb-auto")
              .insertAfter(array[i - 2]);
            $(array[i - 1])
              .parent("li")
              .addClass("keep");
          }
        }
        $("#brand-showcase #light-slider li:not(.keep)").remove();
        $("#brand-showcase #light-slider").addClass("d-flex");
      }
      $("#light-slider .lslide")
        .removeAttr("style")
        .prop("style", "min-height:1px;");
      initBannerSlider();
    })
    .on("resize orientationchange", function () {
      if ($(window).width() < 550) {
        var array = $("#brand-showcase #light-slider li:not(.clone) a");

        for (var i = array.length; i >= 0; i--) {
          if (i % 2 == 0) {
            $(array[i - 1])
              .addClass("mb-auto")
              .insertAfter(array[i - 2]);
            $(array[i - 1])
              .parent("li")
              .addClass("keep");
          }
        }
        $("#brand-showcase #light-slider li:not(.keep)").remove();
        $("#brand-showcase #light-slider").addClass("d-flex");
      }
      initBannerSlider();

      const ct_printProducts = function (products) {
        // Shopping bag icon print
        for (let element in ct_page__products.elements) {
          let shoppingBag;
          if ($(window).width() > 1199) {
            shoppingBag = `<span class="ct_shopping-bag-icon icon-shopping-cart-o ${
              shoppingBagPosition[
                ct_page__products.elements[element][0].shop_icon_position.desk
              ]
            }"></span>`;
          }

          // Banner type structure control
          const dataElementId = `[data-element-id="${element}"]`;

          $(dataElementId).append(shoppingBag);

          const bannerElementIdSelector = $(dataElementId)
            .children()
            .hasClass("cm-hero__media-wrapper")
            ? `${dataElementId} .cm-hero__media-wrapper`
            : `${dataElementId} > a > div`;
          if (
            !$(bannerElementIdSelector).find(".ct_shopping-bag-icon").length
          ) {
            $(bannerElementIdSelector).append(shoppingBag);
          }

          // Desktop and mobile different behaviour
          if ($(window).width() < 768) {
            // ctas always clickables
            $(dataElementId + " a").css("pointerEvents", "auto");
            // Mobile pin show on scroll
            const banners = document.querySelectorAll(dataElementId);
            const observer = new IntersectionObserver(
              (entries) => {
                entries.forEach((entry) => {
                  if (entry.isIntersecting) {
                    entry.target.classList.add("ct_show-pin");
                  }
                });
              },

              { threshold: 0.2 }
            );

            banners.forEach((pin) => {
              observer.observe(pin);
            });

            // Desktop pin show on hover
          } else {
            $(dataElementId).addClass("ct_show-pin");
          }

          // Cycle on products inside each banner (we can have multiple products inside a single banner)

          for (let productIndex in ct_page__products.elements[element]) {
            const ct_productInfo =
              ct_page__products.elements[element][productIndex];

            // Check if an element/product already exist in the banner
            if (
              !$(
                `${bannerElementIdSelector} a[data-element-id="${element}-PIN${productIndex}"]`
              ).length
            ) {
              const ct_shopPin = ct_printPin(
                ct_productInfo,
                element,
                productIndex,
                products
              );

              $(bannerElementIdSelector).append(ct_shopPin);
            }
          }
        }
      };

      // Pin print and positioning inside banner

      const ct_printPin = (pinInfo, dataElementId, productIndex, products) => {
        let pinStyleTop;
        let pinStyleLeft;
        let panelPosition;

        if ($(window).width() < 768) {
          pinStyleTop = pinInfo.top.mob;
          pinStyleLeft = pinInfo.left.mob;
          panelPosition = infoPanelPosition[pinInfo.panel_position.mob];
        } else {
          pinStyleTop = pinInfo.top.desk;
          pinStyleLeft = pinInfo.left.desk;
          panelPosition = infoPanelPosition[pinInfo.panel_position.desk];
        }

        const pinStyle = `top:${pinStyleTop + "%"};left:${pinStyleLeft + "%"};`;

        // Filtering JSON products <-> Products in page

        const productFilter = $(products.products).filter(function (index) {
          return pinInfo.upc === products.products[index].UPC;
        });

        if (productFilter[0] === undefined) return;

        const skuType = productFilter[0].skuType;

        let modelImage = productFilter[0].qtImage;

        const offerPrice = parseFloat(productFilter[0].offerPrice);

        const listPrice = parseFloat(productFilter[0].listPrice);

        const modelName = productFilter[0].modelName;

        const pdpURL = productFilter[0].pdpURL;

        const stock = productFilter[0].stock;

        let imageUrl = modelImage;

        const activePreviewDesktop = pinInfo.preview.desk;

        const activePreviewMobile = pinInfo.preview.mob;

        let previewClass;

        if (activePreviewMobile && activePreviewDesktop) {
          previewClass = "d-block";
        } else if (activePreviewMobile && !activePreviewDesktop) {
          previewClass = "d-block d-md-none";
        } else if (!activePreviewMobile && activePreviewDesktop) {
          previewClass = "d-none d-md-block";
        }

        // Currency

        const currency = "$";

        if (skuType === "AFA Accessories" || skuType === "AFA Apparel") {
          modelImage = productFilter[0].frontImage;

          imageUrl = modelImage

            .replace("CostaDelMar", "CDMAFA")

            .replace("__", "_main_");
        } else if (skuType === "Accessory") {
          imageUrl = modelImage

            .replace("CostaDelMar", "CDMACC")

            .replace("__", "_main_");
        }

        // Has offer price?

        const hasOfferPrice = listPrice !== offerPrice;

        // Is out of stock?

        const isOutOfStock = stock == "0";

        // Render based on different conditions (normal price | offer price | out of stock)

        const printPrice =
          hasOfferPrice && !isOutOfStock
            ? `<p class="ct_infoPanel_productPrice">${currency}<del style="font-size: 11px">${listPrice.toFixed(
                2
              )}</del> <span>${currency}${offerPrice.toFixed(2)}</span></p>`
            : `<p class="ct_infoPanel_productPrice">${currency}${listPrice.toFixed(
                2
              )}</p>`;

        if (isOutOfStock) {
          return `
      
          <div class="ct_pin-container ct_pin-container-not-clickable" style=${pinStyle}>
      
          <div class="ct_pin ct_pin-icon ct_pin-icon-light">
      
          </div>
      
          <div class="ct_infoPanel ${panelPosition}">
      
          <p class="ct_infoPanel_productName">${modelName}</p>
      
          <p class="ct_infoPanel_productPrice">Is Out of Stock</p>
      
          <img src="${imageUrl}?imwidth=220" alt="${modelName}" class="${previewClass}" />
      
          </div>
      
          </div>`;
        } else {
          return `
      
          <div class="ct_pin-container" style=${pinStyle}>
      
          <div class="ct_pin ct_pin-icon ct_pin-icon-light">
      
          </div>
      
          <a data-description="${modelName}" data-element-id="${dataElementId}-PIN${productIndex}" href="${pdpURL}" class="ct_infoPanel ${panelPosition} ct_infoPanel-hidden">
      
          <div>
      
          <p class="ct_infoPanel_productName">${modelName}</p>
      
          ${printPrice}
      
          </div>
      
          <img src="${imageUrl}?imwidth=220" alt="${modelName}" class="${previewClass}" />
      
          </a>
      
        </div>`;
        }
      };

      const ct_HandleOnClickEvents = () => {
        const infoPanels = document.querySelectorAll(".ct_infoPanel");

        const pins = document.querySelectorAll(".ct_pin");

        const shoppingBags = document.querySelectorAll(".ct_shopping-bag-icon");

        // Banner behavior -> Click on image with panels closed redirect

        if (banner_behavior !== "custom") {
          $(document).on("click", function (e) {
            pins.forEach((el) => {
              el.classList.add("ct_pin-icon-light");
              el.classList.remove("ct_pin-icon-dark");
            });

            infoPanels.forEach((el) => {
              el.classList.add("ct_infoPanel-hidden");
              el.classList.remove("ct_infoPanel-visible");
            });

            for (let element in ct_page__products.elements) {
              const dataElementId = `[data-element-id="${element}"]`;

              const banners = document.querySelectorAll(dataElementId);

              banners.forEach((el) => {
                el.classList.remove("ct_preventBannerClick");
              });
            }
          });
        }

        const ct_PanelOpeningLogic = (e, target) => {
          const targetElement = target[0];

          let IsVisible = $(targetElement).hasClass("ct_infoPanel-visible")
            ? true
            : false;

          if (!IsVisible) {
            targetElement.classList.remove("ct_infoPanel-hidden");
            targetElement.classList.add("ct_infoPanel-visible");
          } else {
            targetElement.classList.remove("ct_infoPanel-visible");
            targetElement.classList.add("ct_infoPanel-hidden");
          }

          e.stopPropagation();
          e.stopImmediatePropagation();
        };

        infoPanels.forEach((el) => {
          $(`.ct_infoPanel`).click((e) => {
            e.stopPropagation();

            e.stopImmediatePropagation();
          });

          if ($(window).width() > 767) {
            $(`.ct_infoPanel`).mouseenter((e) => {
              const ct_infoPanels = $(e.currentTarget);

              ct_infoPanels[0].classList.add("ct_infoPanel-visible");

              ct_infoPanels[0].classList.remove("ct_infoPanel-hidden");

              const pin = ct_infoPanels[0].previousElementSibling;

              pin.classList.add("ct_pin-icon-dark");

              pin.classList.remove("ct_pin-icon-light");
            });

            $(`.ct_infoPanel`).mouseleave((e) => {
              const ct_infoPanels = $(e.currentTarget);

              ct_infoPanels[0].classList.remove("ct_infoPanel-visible");

              ct_infoPanels[0].classList.add("ct_infoPanel-hidden");

              const pin = ct_infoPanels[0].previousElementSibling;

              pin.classList.add("ct_pin-icon-light");

              pin.classList.remove("ct_pin-icon-dark");
            });

            $(`.ct_show-pin`).mouseleave((e) => {
              el.classList.remove("ct_infoPanel-visible");

              el.classList.add("ct_infoPanel-hidden");

              const pin = el.previousElementSibling;

              pin.classList.remove("ct_pin-icon-dark");

              pin.classList.add("ct_pin-icon-light");
            });

            $(`.ct_pin`).mouseenter((e) => {
              const ct_pin = $(e.currentTarget);

              ct_pin[0].classList.add("ct_pin-icon-dark");

              ct_pin[0].classList.remove("ct_pin-icon-light");
            });

            $(`.ct_pin`).mouseleave((e) => {
              const ct_pin = $(e.currentTarget);
              ct_pin[0].classList.add("ct_pin-icon-light");

              ct_pin[0].classList.remove("ct_pin-icon-dark");
            });
          }
        });

        pins.forEach((pin) => {
          if ($(window).width() > 767) {
            $(pin).click((e) => {
              e.stopPropagation();

              e.stopImmediatePropagation();
            });

            $(pin).mouseenter((e) => {
              const ct_infoPanels = $(e.currentTarget)
                .next()
                .addClass("ct_infoPanel-visible")
                .removeClass("ct_infoPanel-hidden");
            });

            $(pin).mouseleave((e) => {
              const ct_infoPanels = $(e.currentTarget)
                .next()
                .addClass("ct_infoPanel-hidden")
                .removeClass("ct_infoPanel-visible");
            });
          } else if ($(window).width() < 768) {
            $(pin).click((e) => {
              let banner = $(e.target).closest("[data-element-id]");

              console.log("banner", banner);

              let IsVisible = $(e.target).hasClass("ct_pin-icon-dark")
                ? true
                : false;

              if (IsVisible) {
                $(e.target)
                  .addClass("ct_pin-icon-light")

                  .removeClass("ct_pin-icon-dark");
              } else {
                $(e.target)
                  .addClass("ct_pin-icon-dark")

                  .removeClass("ct_pin-icon-light");
              }

              const ct_infoPanels = $(e.target).next();

              ct_PanelOpeningLogic(e, ct_infoPanels);

              // Banner behavior -> Click on image with panels closed redirect

              if (banner_behavior !== "custom") {
                const ct_infoPanelsActive = banner[0].querySelectorAll(
                  ".ct_infoPanel.ct_infoPanel-visible"
                );

                const ct_infoPanelsHidden = banner[0].querySelectorAll(
                  ".ct_infoPanel.ct_infoPanel-hidden"
                );

                if (ct_infoPanelsActive.length > 0) {
                  $(banner[0]).addClass("ct_preventBannerClick");
                } else {
                  $(banner[0]).removeClass("ct_preventBannerClick");
                }
              }
            });
          }
        });

        shoppingBags.forEach((shoppingBag) => {
          // Banner behavior -> Click on image with panels closed redirect
          let bannerSelector;

          if (banner_behavior !== "custom") {
            bannerSelector = shoppingBag;
          } else {
            bannerSelector = $(shoppingBag).parent();
          }

          $(bannerSelector).click((e) => {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();

            let ct_pinContainers;

            let banner;

            if (banner_behavior !== "custom") {
              ct_pinContainers = $(e.target).parent();

              banner = $(e.target).closest("[data-element-id]");
            } else {
              ct_pinContainers = bannerSelector;

              banner = $(e.target).closest("[data-element-id]");
            }

            const ct_infoPanelsActive = ct_pinContainers[0].querySelectorAll(
              ".ct_infoPanel.ct_infoPanel-visible"
            );

            const ct_infoPanelsHidden = ct_pinContainers[0].querySelectorAll(
              ".ct_infoPanel.ct_infoPanel-hidden"
            );

            const ct_infoPanels =
              ct_infoPanelsActive.length === 0 ||
              ct_infoPanelsHidden.length === 0
                ? ct_pinContainers[0].querySelectorAll(".ct_infoPanel")
                : ct_infoPanelsHidden;

            for (let i = 0; i < ct_infoPanels.length; i++) {
              ct_infoPanels[i].classList.toggle("ct_infoPanel-hidden");

              ct_infoPanels[i].classList.toggle("ct_infoPanel-visible");
            }

            const ct_pinActive = ct_pinContainers[0].querySelectorAll(
              ".ct_pin.ct_pin-icon-dark"
            );

            const ct_pinHidden = ct_pinContainers[0].querySelectorAll(
              ".ct_pin.ct_pin-icon-light"
            );

            const ct_pinIcons =
              ct_pinActive.length === 0 || ct_pinHidden.length === 0
                ? ct_pinContainers[0].querySelectorAll(".ct_pin")
                : ct_pinHidden;

            for (let i = 0; i < ct_pinIcons.length; i++) {
              ct_pinIcons[i].classList.toggle("ct_pin-icon-light");

              ct_pinIcons[i].classList.toggle("ct_pin-icon-dark");
            }
          });
        });
      };
    });

  /* UTILS */
  function isTestingParameter(date) {
    const url = window.location.href;
    return url.includes(`?test=true&date=${date}`);
  }
  /* END UTILS*/
</script>
